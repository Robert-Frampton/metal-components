{"version":3,"sources":["AutocompleteBase.js"],"names":["AutocompleteBase","eventHandler_","on","select","inputElement","add","handleUserInput_","bind","removeAllListeners","request","value","query","self","pendingRequest","cancel","deferredData","data","isPromise","resolve","then","Array","isArray","map","format","filter","isDefAndNotNull","val","isFunction","STATE","setter","identityFunction","validator","toElement","selectedValue","text","focus","visible","isBoolean"],"mappings":";AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAWMA,gB;;;;;;;;;;;6BAIK;AACT,SAAKC,aAAL,GAAqB,0BAArB;AACA,SAAKC,EAAL,CAAQ,QAAR,EAAkB,KAAKC,MAAvB;AACA;;;8BAKU;AACV,QAAI,KAAKC,YAAT,EAAuB;AACtB,UAAKH,aAAL,CAAmBI,GAAnB,CAAuB,cAAIH,EAAJ,CAAO,KAAKE,YAAZ,EAA0B,OAA1B,EAAmC,KAAKE,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CAAnC,CAAvB;AACA;AACD;;;8BAKU;AACV,SAAKN,aAAL,CAAmBO,kBAAnB;AACA;;;sCAOkB;AAClB,SAAKC,OAAL,CAAa,KAAKL,YAAL,CAAkBM,KAA/B;AACA;;;2BAOOC,K,EAAO;AACd,QAAIC,OAAO,IAAX;;AAEA,QAAI,KAAKC,cAAT,EAAyB;AACxB,UAAKA,cAAL,CAAoBC,MAApB,CAA2B,8BAA3B;AACA;;AAED,QAAIC,eAAeH,KAAKI,IAAL,CAAUL,KAAV,CAAnB;AACA,QAAI,CAAC,gBAAKM,SAAL,CAAeF,YAAf,CAAL,EAAmC;AAClCA,oBAAe,kBAAmBG,OAAnB,CAA2BH,YAA3B,CAAf;AACA;;AAED,SAAKF,cAAL,GAAsBE,aAAaI,IAAb,CAAkB,UAASH,IAAT,EAAe;AACtD,SAAII,MAAMC,OAAN,CAAcL,IAAd,CAAJ,EAAyB;AACxB,aAAOA,KAAKM,GAAL,CAASV,KAAKW,MAAL,CAAYhB,IAAZ,CAAiBK,IAAjB,CAAT,EAAiCY,MAAjC,CAAwC;AAAA,cAAO,gBAAKC,eAAL,CAAqBC,GAArB,CAAP;AAAA,OAAxC,CAAP;AACA;AACD,KAJqB,CAAtB;;AAMA,WAAO,KAAKb,cAAZ;AACA;;;4BASQa,G,EAAK;AACb,QAAI,CAAC,gBAAKC,UAAL,CAAgBD,GAAhB,CAAL,EAA2B;AAC1B,YAAO,YAAW;AACjB,aAAOA,GAAP;AACA,MAFD;AAGA;AACD,WAAOA,GAAP;AACA;;;;;;AAGF;;;;;AAKA1B,kBAAiB4B,KAAjB,GAAyB;AACxB;;;;;;AAMAZ,QAAM;AACLa,WAAQ;AADH,GAPkB;;AAWxB;;;;;AAKAN,UAAQ;AACPb,UAAO,gBAAKoB,gBADL;AAEPC,cAAW,gBAAKJ;AAFT,GAhBgB;;AAqBxB;;;;AAIAvB,gBAAc;AACbyB,WAAQ,cAAIG;AADC,GAzBU;;AA6BxB;;;;;;;;;;AAUA7B,UAAQ;AACPO,UAAO,eAASuB,aAAT,EAAwB;AAC9B,SAAK7B,YAAL,CAAkBM,KAAlB,GAA0BuB,cAAcC,IAAxC;AACA,SAAK9B,YAAL,CAAkB+B,KAAlB;AACA,IAJM;AAKPJ,cAAW,gBAAKJ;AALT,GAvCgB;;AA+CxB;;;;AAIAS,WAAS;AACRL,cAAW,gBAAKM,SADR;AAER3B,UAAO;AAFC;AAnDe,EAAzB;;mBAyDeV,gB","file":"node_modules/metal-autocomplete/src/AutocompleteBase.js","sourcesContent":["'use strict';\n\nimport core from 'metal';\nimport dom from 'metal-dom';\nimport CancellablePromise from 'metal-promise';\nimport Component from 'metal-component';\nimport { EventHandler } from 'metal-events';\n\n/*\n * AutocompleteBase component.\n */\nclass AutocompleteBase extends Component {\n\t/**\n\t * @inheritDoc\n\t */\n\tcreated() {\n\t\tthis.eventHandler_ = new EventHandler();\n\t\tthis.on('select', this.select);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tattached() {\n\t\tif (this.inputElement) {\n\t\t\tthis.eventHandler_.add(dom.on(this.inputElement, 'input', this.handleUserInput_.bind(this)));\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdetached() {\n\t\tthis.eventHandler_.removeAllListeners();\n\t}\n\n\t/**\n\t * Handles the user input.\n\t * @param {!Event} event\n\t * @protected\n\t */\n\thandleUserInput_() {\n\t\tthis.request(this.inputElement.value);\n\t}\n\n\t/**\n\t * Cancels pending request and starts a request for the user input.\n\t * @param {string} query\n\t * @return {!CancellablePromise} Deferred request.\n\t */\n\trequest(query) {\n\t\tvar self = this;\n\n\t\tif (this.pendingRequest) {\n\t\t\tthis.pendingRequest.cancel('Cancelled by another request');\n\t\t}\n\n\t\tvar deferredData = self.data(query);\n\t\tif (!core.isPromise(deferredData)) {\n\t\t\tdeferredData = CancellablePromise.resolve(deferredData);\n\t\t}\n\n\t\tthis.pendingRequest = deferredData.then(function(data) {\n\t\t\tif (Array.isArray(data)) {\n\t\t\t\treturn data.map(self.format.bind(self)).filter(val => core.isDefAndNotNull(val));\n\t\t\t}\n\t\t});\n\n\t\treturn this.pendingRequest;\n\t}\n\n\t/**\n\t * Normalizes the provided data value. If the value is not a function, the\n\t * value will be wrapped in a function which returns the provided value.\n\t * @param {Array.<object>|Promise|function} val The provided value which\n\t *     have to be normalized.\n\t * @protected\n\t */\n\tsetData_(val) {\n\t\tif (!core.isFunction(val)) {\n\t\t\treturn function() {\n\t\t\t\treturn val;\n\t\t\t};\n\t\t}\n\t\treturn val;\n\t}\n}\n\n/**\n * AutocompleteBase state definition.\n * @type {!Object}\n * @static\n */\nAutocompleteBase.STATE = {\n\t/**\n\t * Function or array, which have to return the results from the query.\n\t * If function, it should return an `array` or a `Promise`. In case of\n\t * Promise, it should be resolved with an array containing the results.\n\t * @type {Array.<object>|function}\n\t */\n\tdata: {\n\t\tsetter: 'setData_'\n\t},\n\n\t/**\n\t * Function that formats each item of the data.\n\t * @type {function}\n\t * @default Identity function.\n\t */\n\tformat: {\n\t\tvalue: core.identityFunction,\n\t\tvalidator: core.isFunction\n\t},\n\n\t/**\n\t * The element which will be used source for the data queries.\n\t * @type {DOMElement|string}\n\t */\n\tinputElement: {\n\t\tsetter: dom.toElement\n\t},\n\n\t/**\n\t * Handles item selection. It will receive two parameters - the selected\n\t * value from the user and the current value from the input element.\n\t * @type {function}\n\t * @default\n\t *   function(selectedValue) {\n\t *\t   this.inputElement.value = selectedValue;\n\t *\t   this.inputElement.focus();\n\t *   }\n\t */\n\tselect: {\n\t\tvalue: function(selectedValue) {\n\t\t\tthis.inputElement.value = selectedValue.text;\n\t\t\tthis.inputElement.focus();\n\t\t},\n\t\tvalidator: core.isFunction\n\t},\n\n\t/**\n\t * Indicates if the component is visible or not.\n\t * @type {boolean}\n\t */\n\tvisible: {\n\t\tvalidator: core.isBoolean,\n\t\tvalue: false\n\t}\n};\n\nexport default AutocompleteBase;\n"],"sourceRoot":"/source/"}