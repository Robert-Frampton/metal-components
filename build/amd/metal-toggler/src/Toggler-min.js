define(["exports","metal/src/metal","metal-dom/src/all/dom","metal-events/src/events","metal-state/src/State"],function(e,t,n,r,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var d=o(t),u=o(n),c=o(a),h=function(e){function t(n){l(this,t);var a=s(this,e.call(this,n));return a.headerEventHandler_=new r.EventHandler,a.on("headerChanged",a.syncHeader),a.syncHeader(),a}return i(t,e),t.prototype.disposeInternal=function(){e.prototype.disposeInternal.call(this),this.headerEventHandler_.removeAllListeners()},t.prototype.getContentElement_=function(e){if(d["default"].isElement(this.content))return this.content;var t=u["default"].next(e,this.content);return t?t:(t=e.querySelector(this.content),t?t:this.container.querySelector(this.content))},t.prototype.handleClick_=function(e){this.toggle(e.delegateTarget||e.currentTarget)},t.prototype.handleKeydown_=function(e){13!==e.keyCode&&32!==e.keyCode||(this.toggle(e.delegateTarget||e.currentTarget),e.preventDefault())},t.prototype.syncHeader=function(){this.headerEventHandler_.removeAllListeners(),this.header&&(d["default"].isString(this.header)?this.headerEventHandler_.add(u["default"].delegate(this.container,"click",this.header,this.handleClick_.bind(this)),u["default"].delegate(this.container,"keydown",this.header,this.handleKeydown_.bind(this))):this.headerEventHandler_.add(u["default"].on(this.header,"click",this.handleClick_.bind(this)),u["default"].on(this.header,"keydown",this.handleKeydown_.bind(this))))},t.prototype.toggle=function(e){var n=this.getContentElement_(e);u["default"].toggleClasses(n,t.CSS_EXPANDED),u["default"].toggleClasses(n,t.CSS_COLLAPSED),u["default"].hasClass(n,t.CSS_EXPANDED)?(u["default"].addClasses(e,t.CSS_HEADER_EXPANDED),u["default"].removeClasses(e,t.CSS_HEADER_COLLAPSED)):(u["default"].removeClasses(e,t.CSS_HEADER_EXPANDED),u["default"].addClasses(e,t.CSS_HEADER_COLLAPSED))},t}(c["default"]);h.STATE={container:{setter:u["default"].toElement,validator:function(e){return d["default"].isString(e)||d["default"].isElement(e)},value:document},content:{validator:function(e){return d["default"].isString(e)||d["default"].isElement(e)}},header:{validator:function(e){return d["default"].isString(e)||d["default"].isElement(e)}}},h.CSS_COLLAPSED="toggler-collapsed",h.CSS_EXPANDED="toggler-expanded",h.CSS_HEADER_COLLAPSED="toggler-header-collapsed",h.CSS_HEADER_EXPANDED="toggler-header-expanded",e["default"]=h});