{"version":3,"sources":["Datatable.js"],"names":["Datatable","value","lastType","acceptArray","v","type","getValueType_","assertSameTypes_","assertNoMixedTypesInArrays_","acceptObject","visit_","type1","type2","Error","expandedValue","isFirstArrayItemObject","TYPES","OBJECT","columns","columnsType","forEach","item","Object","keys","key","formatColumns","formatColumnsType","ARRAY","collectColumnsFromArrayValues_","collectColumnsFromObjectKeys_","NULL","undefined","UNDEFINED","Array","isArray","isObject","contentKind","STRING","data","isAlreadyExpanded","visitValuesAndExpandType_","visitValuesAndWrapStringValues_","event","label","delegateTarget","toggleClasses","labelClasses","next","hiddenClasses","k","val","reference","expanded","collectColumnsFromValues_","toIncDom","register","STATE","setter","displayColumnsType","validator","isBoolean","isFunction","sort","columnstype","isString","tableClasses","BOOLEAN","NUMBER"],"mappings":";AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAQMA,S;;;;;;;;;;;+CAQuBC,K,EAAO;AAAA;;AAClC,QAAIC,QAAJ;AACA,QAAIC,cAAc,SAAdA,WAAc,CAACC,CAAD,EAAO;AACxB,SAAIC,OAAO,OAAKC,aAAL,CAAmBF,CAAnB,CAAX;AACA,YAAKG,gBAAL,CAAsBL,QAAtB,EAAgCG,IAAhC;AACAH,gBAAWG,IAAX;AACA,YAAKG,2BAAL,CAAiCJ,CAAjC;AACA,KALD;AAMA,QAAIK,eAAe,SAAfA,YAAe,CAACL,CAAD;AAAA,YAAO,OAAKI,2BAAL,CAAiCJ,CAAjC,CAAP;AAAA,KAAnB;AACA,SAAKM,MAAL,CAAYT,KAAZ,EAAmBE,WAAnB,EAAgCM,YAAhC;AACA;;;oCASgBE,K,EAAOC,K,EAAO;AAC9B,QAAID,SAASC,KAAT,IAAkBD,UAAUC,KAAhC,EAAuC;AACtC,WAAM,IAAIC,KAAJ,CAAU,mDAAV,CAAN;AACA;AACD;;;kDAS8BC,a,EAAe;AAAA;;AAC7C,QAAIb,QAAQa,cAAcb,KAA1B;AACA,QAAIc,yBAAyBd,MAAM,CAAN,KAAYA,MAAM,CAAN,EAASI,IAAT,KAAkBL,UAAUgB,KAAV,CAAgBC,MAA3E;AACA,QAAIF,sBAAJ,EAA4B;AAAA;AAC3B,UAAIG,UAAU,EAAd;AACA,UAAIC,cAAc,EAAlB;AACAlB,YAAMmB,OAAN,CAAc,UAACC,IAAD;AAAA,cAAUC,OAAOC,IAAP,CAAYF,KAAKpB,KAAjB,EAAwBmB,OAAxB,CAAgC,UAACI,GAAD,EAAS;AAChEN,gBAAQM,GAAR,IAAe,IAAf;AACAL,oBAAYK,GAAZ,IAAmBH,KAAKpB,KAAL,CAAWuB,GAAX,EAAgBnB,IAAnC;AACA,QAHuB,CAAV;AAAA,OAAd;AAIAS,oBAAcI,OAAd,GAAwB,OAAKO,aAAL,CAAmBH,OAAOC,IAAP,CAAYL,OAAZ,CAAnB,CAAxB;AACAJ,oBAAcK,WAAd,GAA4B,OAAKO,iBAAL,CAAuBP,WAAvB,CAA5B;AAR2B;AAS3B;AACD;;;iDAO6BL,a,EAAe;AAC5C,QAAIb,QAAQa,cAAcb,KAA1B;AACA,QAAIiB,UAAU,EAAd;AACA,QAAIC,cAAc,EAAlB;AACAG,WAAOC,IAAP,CAAYtB,KAAZ,EAAmBmB,OAAnB,CAA2B,UAACI,GAAD,EAAS;AACnCN,aAAQM,GAAR,IAAe,IAAf;AACAL,iBAAYK,GAAZ,IAAmBvB,MAAMuB,GAAN,EAAWnB,IAA9B;AACA,KAHD;AAIAS,kBAAcI,OAAd,GAAwB,KAAKO,aAAL,CAAmBH,OAAOC,IAAP,CAAYL,OAAZ,CAAnB,CAAxB;AACAJ,kBAAcK,WAAd,GAA4B,KAAKO,iBAAL,CAAuBP,WAAvB,CAA5B;AACA;;;6CAQyBL,a,EAAe;AACxC,YAAQA,cAAcT,IAAtB;AACC,UAAKL,UAAUgB,KAAV,CAAgBW,KAArB;AACC,WAAKC,8BAAL,CAAoCd,aAApC;AACA;AACD,UAAKd,UAAUgB,KAAV,CAAgBC,MAArB;AACC,WAAKY,6BAAL,CAAmCf,aAAnC;AACA;AANF;AAQA;;;iCAOab,K,EAAO;AACpB,QAAIA,UAAU,IAAd,EAAoB;AACnB,YAAOD,UAAUgB,KAAV,CAAgBc,IAAvB;AACA;AACD,QAAI7B,UAAU8B,SAAd,EAAyB;AACxB,YAAO/B,UAAUgB,KAAV,CAAgBgB,SAAvB;AACA;AACD,QAAIC,MAAMC,OAAN,CAAcjC,KAAd,CAAJ,EAA0B;AACzB,YAAOD,UAAUgB,KAAV,CAAgBW,KAAvB;AACA;AACD,QAAI,gBAAKQ,QAAL,CAAclC,KAAd,KAAwBA,MAAMmC,WAAN,KAAsB,MAAlD,EAA0D;AACzD,YAAOpC,UAAUgB,KAAV,CAAgBqB,MAAvB;AACA;AACD,kBAAcpC,KAAd,yCAAcA,KAAd;AACA;;;qCAOiBqC,I,EAAM;AACvB,WAAO,gBAAKH,QAAL,CAAcG,IAAd,KAAuB,aAAaA,IAApC,IAA4C,UAAUA,IAA7D;AACA;;;4BAEQA,I,EAAM;AACd,QAAI,CAAC,KAAKC,iBAAL,CAAuBD,IAAvB,CAAL,EAAmC;AAClC,UAAK9B,2BAAL,CAAiC8B,IAAjC;AACAA,YAAO,KAAKE,yBAAL,CAA+BF,IAA/B,CAAP;AACA;AACD,WAAO,KAAKG,+BAAL,CAAqCH,IAArC,CAAP;AACA;;;uCAMmBI,K,EAAO;AAC1B,QAAIC,QAAQD,MAAME,cAAlB;AACA,kBAAIC,aAAJ,CAAkBF,KAAlB,EAAyB,KAAKG,YAA9B;AACA,kBAAID,aAAJ,CAAkB,cAAIE,IAAJ,CAASJ,KAAT,EAAgB,OAAhB,CAAlB,EAA4C,KAAKK,aAAjD;AACA;;;0BASM/C,K,EAAOE,W,EAAaM,Y,EAAc;AACxC,YAAQ,KAAKH,aAAL,CAAmBL,KAAnB,CAAR;AACC,UAAKD,UAAUgB,KAAV,CAAgBW,KAArB;AACC1B,YAAMmB,OAAN,CAAc,UAAChB,CAAD,EAAI6C,CAAJ;AAAA,cAAU9C,YAAYC,CAAZ,EAAe6C,CAAf,EAAkBhD,KAAlB,CAAV;AAAA,OAAd;AACA;AACD,UAAKD,UAAUgB,KAAV,CAAgBC,MAArB;AACCK,aAAOC,IAAP,CAAYtB,KAAZ,EAAmBmB,OAAnB,CAA2B,UAAC6B,CAAD;AAAA,cAAOxC,aAAaR,MAAMgD,CAAN,CAAb,EAAuBA,CAAvB,EAA0BhD,KAA1B,CAAP;AAAA,OAA3B;AACA;AANF;AAQA;;;6CASyBA,K,EAAO;AAAA;;AAChC,QAAIE,cAAc,SAAdA,WAAc,CAAC+C,GAAD,EAAM1B,GAAN,EAAW2B,SAAX;AAAA,YAAyBA,UAAU3B,GAAV,IAAiB,OAAKgB,yBAAL,CAA+BU,GAA/B,CAA1C;AAAA,KAAlB;AACA,QAAIzC,eAAe,SAAfA,YAAe,CAACyC,GAAD,EAAM1B,GAAN,EAAW2B,SAAX;AAAA,YAAyBA,UAAU3B,GAAV,IAAiB,OAAKgB,yBAAL,CAA+BU,GAA/B,CAA1C;AAAA,KAAnB;AACA,SAAKxC,MAAL,CAAYT,KAAZ,EAAmBE,WAAnB,EAAgCM,YAAhC;AACA,QAAIJ,OAAO,KAAKC,aAAL,CAAmBL,KAAnB,CAAX;AACA,QAAImD,WAAW;AACd/C,WAAMA,IADQ;AAEdJ,YAAOA;AAFO,KAAf;AAIA,SAAKoD,yBAAL,CAA+BD,QAA/B;AACA,WAAOA,QAAP;AACA;;;mDAS+BnD,K,EAAO;AAAA;;AACtC,QAAIE,cAAc,SAAdA,WAAc,CAAC+C,GAAD,EAAM1B,GAAN,EAAW2B,SAAX;AAAA,YAAyBA,UAAU3B,GAAV,IAAiB,OAAKiB,+BAAL,CAAqCS,GAArC,CAA1C;AAAA,KAAlB;AACA,QAAIzC,eAAe,SAAfA,YAAe,CAACyC,GAAD,EAAM1B,GAAN,EAAW2B,SAAX;AAAA,YAAyBA,UAAU3B,GAAV,IAAiB,OAAKiB,+BAAL,CAAqCS,GAArC,CAA1C;AAAA,KAAnB;AACA,SAAKxC,MAAL,CAAYT,KAAZ,EAAmBE,WAAnB,EAAgCM,YAAhC;AACA,QAAI,gBAAK0B,QAAL,CAAclC,KAAd,CAAJ,EAA0B;AACzB,SAAII,OAAO,KAAKC,aAAL,CAAmBL,MAAMA,KAAzB,CAAX;AACA,SAAII,SAASL,UAAUgB,KAAV,CAAgBqB,MAA7B,EAAqC;AACpCpC,YAAMA,KAAN,GAAc,cAAIqD,QAAJ,CAAarD,MAAMA,KAAnB,CAAd;AACA;AACD;AACD,WAAOA,KAAP;AACA;;;;;;AAGF,eAAIsD,QAAJ,CAAavD,SAAb;;AAEAA,WAAUwD,KAAV,GAAkB;AACjB;;;;;AAKAlB,QAAM;AACLmB,WAAQ;AADH,GANW;;AAUjB;;;;;AAKAC,sBAAoB;AACnBC,cAAW,gBAAKC,SADG;AAEnB3D,UAAO;AAFY,GAfH;;AAoBjB;;;;;AAKAwB,iBAAe;AACdkC,cAAW,gBAAKE,UADF;AAEd5D,UAAO,eAASiB,OAAT,EAAkB;AACxB,WAAOA,QAAQ4C,IAAR,EAAP;AACA;AAJa,GAzBE;;AAgCjB;;;;;AAKApC,qBAAmB;AAClBiC,cAAW,gBAAKE,UADE;AAElB5D,UAAO,eAAS8D,WAAT,EAAsB;AAC5B,WAAOA,WAAP;AACA;AAJiB,GArCF;;AA4CjB;;;;;AAKAf,iBAAe;AACdW,cAAW,gBAAKK,QADF;AAEd/D,UAAO;AAFO,GAjDE;;AAsDjB;;;;;AAKA6C,gBAAc;AACba,cAAW,gBAAKK,QADH;AAEb/D,UAAO;AAFM,GA3DG;;AAgEjB;;;;;AAKAgE,gBAAc;AACbN,cAAW,gBAAKK,QADH;AAEb/D,UAAO;AAFM;AArEG,EAAlB;;AA2EA;;;;;AAKAD,WAAUgB,KAAV,GAAkB;AACjBW,SAAO,OADU;AAEjBuC,WAAS,SAFQ;AAGjBpC,QAAM,MAHW;AAIjBqC,UAAQ,QAJS;AAKjBlD,UAAQ,QALS;AAMjBoB,UAAQ,QANS;AAOjBL,aAAW;AAPM,EAAlB;;mBAUehC,S;AACoD,yBAAcuD,QAAd,CAAuB,WAAvB,EAAoCvD,SAApC","file":"node_modules/metal-datatable/src/Datatable.js","sourcesContent":["'use strict';\n\nimport core from 'metal';\nimport dom from 'metal-dom';\nimport templates from './Datatable.soy.js';\nimport Component from 'metal-component';\nimport Soy from 'metal-soy';\n\nclass Datatable extends Component {\n\n\t/**\n\t * Visits array items and asserts that it only contains one literal type.\n\t * @param {array} value\n\t * @protected\n\t * @throws {Error} If types are different.\n\t */\n\tassertNoMixedTypesInArrays_(value) {\n\t\tvar lastType;\n\t\tvar acceptArray = (v) => {\n\t\t\tvar type = this.getValueType_(v);\n\t\t\tthis.assertSameTypes_(lastType, type);\n\t\t\tlastType = type;\n\t\t\tthis.assertNoMixedTypesInArrays_(v);\n\t\t};\n\t\tvar acceptObject = (v) => this.assertNoMixedTypesInArrays_(v);\n\t\tthis.visit_(value, acceptArray, acceptObject);\n\t}\n\n\t/**\n\t * Asserts literal types are not the same.\n\t * @param {string} type1\n\t * @param {string} type2\n\t * @protected\n\t * @throws {Error} If types are different.\n\t */\n\tassertSameTypes_(type1, type2) {\n\t\tif (type1 && type2 && type1 !== type2) {\n\t\t\tthrow new Error('Datatable does not support mixed types in arrays.');\n\t\t}\n\t}\n\n\t/**\n\t * Extract keys from an array of objects. Column values are aggregated from\n\t * extracting 1-deep key values. For other array types keys are not\n\t * extracted and values are plotted in one column vertically.\n\t * @param {object} expandedValue\n\t * @protected\n\t */\n\tcollectColumnsFromArrayValues_(expandedValue) {\n\t\tvar value = expandedValue.value;\n\t\tvar isFirstArrayItemObject = value[0] && value[0].type === Datatable.TYPES.OBJECT;\n\t\tif (isFirstArrayItemObject) {\n\t\t\tlet columns = {};\n\t\t\tlet columnsType = {};\n\t\t\tvalue.forEach((item) => Object.keys(item.value).forEach((key) => {\n\t\t\t\tcolumns[key] = true;\n\t\t\t\tcolumnsType[key] = item.value[key].type;\n\t\t\t}));\n\t\t\texpandedValue.columns = this.formatColumns(Object.keys(columns));\n\t\t\texpandedValue.columnsType = this.formatColumnsType(columnsType);\n\t\t}\n\t}\n\n\t/**\n\t * Extract columns from object keys.\n\t * @param {object} expandedValue\n\t * @protected\n\t */\n\tcollectColumnsFromObjectKeys_(expandedValue) {\n\t\tvar value = expandedValue.value;\n\t\tlet columns = {};\n\t\tlet columnsType = {};\n\t\tObject.keys(value).forEach((key) => {\n\t\t\tcolumns[key] = true;\n\t\t\tcolumnsType[key] = value[key].type;\n\t\t});\n\t\texpandedValue.columns = this.formatColumns(Object.keys(columns));\n\t\texpandedValue.columnsType = this.formatColumnsType(columnsType);\n\t}\n\n\t/**\n\t * Analyzes the expanded object containing type and value and extracts an\n\t * array of columns to be used for plotting.\n\t * @param {object} expandedValue\n\t * @protected\n\t */\n\tcollectColumnsFromValues_(expandedValue) {\n\t\tswitch (expandedValue.type) {\n\t\t\tcase Datatable.TYPES.ARRAY:\n\t\t\t\tthis.collectColumnsFromArrayValues_(expandedValue);\n\t\t\t\tbreak;\n\t\t\tcase Datatable.TYPES.OBJECT:\n\t\t\t\tthis.collectColumnsFromObjectKeys_(expandedValue);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t * Internal helper to get literal JSON type of a value.\n\t * @param {*} value\n\t * @return {string} Type inferred from JSON value.\n\t */\n\tgetValueType_(value) {\n\t\tif (value === null) {\n\t\t\treturn Datatable.TYPES.NULL;\n\t\t}\n\t\tif (value === undefined) {\n\t\t\treturn Datatable.TYPES.UNDEFINED;\n\t\t}\n\t\tif (Array.isArray(value)) {\n\t\t\treturn Datatable.TYPES.ARRAY;\n\t\t}\n\t\tif (core.isObject(value) && value.contentKind === 'HTML') {\n\t\t\treturn Datatable.TYPES.STRING;\n\t\t}\n\t\treturn typeof value;\n\t}\n\n\t/**\n\t * Returns true if data is already expanded, false otherwise.\n\t * @param {*} data\n\t * @return {boolean}\n\t */\n\tisAlreadyExpanded(data) {\n\t\treturn core.isObject(data) && 'columns' in data && 'type' in data;\n\t}\n\n\tsetData_(data) {\n\t\tif (!this.isAlreadyExpanded(data)) {\n\t\t\tthis.assertNoMixedTypesInArrays_(data);\n\t\t\tdata = this.visitValuesAndExpandType_(data);\n\t\t}\n\t\treturn this.visitValuesAndWrapStringValues_(data);\n\t}\n\n\t/**\n\t * Toggles sibling table content of <code>event.delegateTarget</code>.\n\t * @param {Event} event\n\t */\n\ttoggleTableContents(event) {\n\t\tvar label = event.delegateTarget;\n\t\tdom.toggleClasses(label, this.labelClasses);\n\t\tdom.toggleClasses(dom.next(label, 'table'), this.hiddenClasses);\n\t}\n\n\t/**\n\t * Internal non-recursive visitor helper to navigate over JSON values.\n\t * @param {*} value The value to start the visit.\n\t * @param {!function} acceptArray Accept logic for array items.\n\t * @param {!function} acceptObject Accept logic for object keys and values.\n\t * @protected\n\t */\n\tvisit_(value, acceptArray, acceptObject) {\n\t\tswitch (this.getValueType_(value)) {\n\t\t\tcase Datatable.TYPES.ARRAY:\n\t\t\t\tvalue.forEach((v, k) => acceptArray(v, k, value));\n\t\t\t\tbreak;\n\t\t\tcase Datatable.TYPES.OBJECT:\n\t\t\t\tObject.keys(value).forEach((k) => acceptObject(value[k], k, value));\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t/**\n\t * Visits all json values and wraps it in object containing its type and\n\t * value.\n\t * @param {*} value The value to start the visit.\n\t * @return {object} Wrapped object containing type and value.\n\t * @protected\n\t */\n\tvisitValuesAndExpandType_(value) {\n\t\tvar acceptArray = (val, key, reference) => reference[key] = this.visitValuesAndExpandType_(val);\n\t\tvar acceptObject = (val, key, reference) => reference[key] = this.visitValuesAndExpandType_(val);\n\t\tthis.visit_(value, acceptArray, acceptObject);\n\t\tvar type = this.getValueType_(value);\n\t\tvar expanded = {\n\t\t\ttype: type,\n\t\t\tvalue: value\n\t\t};\n\t\tthis.collectColumnsFromValues_(expanded);\n\t\treturn expanded;\n\t}\n\n\t/**\n\t * Visits all json values and wraps it in special `Soy.toIncDom` helper if\n\t * it's string.\n\t * @param {*} value The value to start the visit.\n\t * @return {object} Wrapped string.\n\t * @protected\n\t */\n\tvisitValuesAndWrapStringValues_(value) {\n\t\tvar acceptArray = (val, key, reference) => reference[key] = this.visitValuesAndWrapStringValues_(val);\n\t\tvar acceptObject = (val, key, reference) => reference[key] = this.visitValuesAndWrapStringValues_(val);\n\t\tthis.visit_(value, acceptArray, acceptObject);\n\t\tif (core.isObject(value)) {\n\t\t\tvar type = this.getValueType_(value.value);\n\t\t\tif (type === Datatable.TYPES.STRING) {\n\t\t\t\tvalue.value = Soy.toIncDom(value.value);\n\t\t\t}\n\t\t}\n\t\treturn value;\n\t}\n\n}\nSoy.register(Datatable, templates);\n\nDatatable.STATE = {\n\t/**\n\t * Data to be plotted on datatable. Any JSON type is supported if it does\n\t * not contain mixed types inside an array.\n\t * @type {*}\n\t */\n\tdata: {\n\t\tsetter: 'setData_'\n\t},\n\n\t/**\n\t * If true displays types in column.\n\t * @type {boolean}\n\t * @default true\n\t */\n\tdisplayColumnsType: {\n\t\tvalidator: core.isBoolean,\n\t\tvalue: true\n\t},\n\n\t/**\n\t * Formats array of columns extracted from JSON data. Relevant for operates\n\t * over column values, such as sorting and formatting.\n\t * @type {function(array.<string>)}\n\t */\n\tformatColumns: {\n\t\tvalidator: core.isFunction,\n\t\tvalue: function(columns) {\n\t\t\treturn columns.sort();\n\t\t}\n\t},\n\n\t/**\n\t * Formats map of columns type extracted from JSON data. Relevant for\n\t * operates over column values, such as sorting and formatting.\n\t * @type {function(map.<string,string>)}\n\t */\n\tformatColumnsType: {\n\t\tvalidator: core.isFunction,\n\t\tvalue: function(columnstype) {\n\t\t\treturn columnstype;\n\t\t}\n\t},\n\n\t/**\n\t * Css classes to be used for hidden state.\n\t * @type {string}\n\t * @default 'hidden'\n\t */\n\thiddenClasses: {\n\t\tvalidator: core.isString,\n\t\tvalue: 'hidden'\n\t},\n\n\t/**\n\t * Css classes to be used for labels.\n\t * @type {string}\n\t * @default 'collapsed expanded'\n\t */\n\tlabelClasses: {\n\t\tvalidator: core.isString,\n\t\tvalue: 'collapsed expanded'\n\t},\n\n\t/**\n\t * Css classes to be used for tables.\n\t * @type {string}\n\t * @default 'table table-condensed table-hover'\n\t */\n\ttableClasses: {\n\t\tvalidator: core.isString,\n\t\tvalue: 'table table-bordered table-condensed table-hover'\n\t}\n};\n\n/**\n * Datatable supported types.\n * @type {object}\n * @static\n */\nDatatable.TYPES = {\n\tARRAY: 'array',\n\tBOOLEAN: 'boolean',\n\tNULL: 'null',\n\tNUMBER: 'number',\n\tOBJECT: 'object',\n\tSTRING: 'string',\n\tUNDEFINED: 'undefined'\n};\n\nexport default Datatable;\nimport JQueryAdapter from 'metal-jquery-adapter/src/JQueryAdapter';JQueryAdapter.register('datatable', Datatable);"],"sourceRoot":"/source/"}