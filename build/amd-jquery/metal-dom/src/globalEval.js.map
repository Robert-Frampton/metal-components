{"version":3,"sources":["globalEval.js"],"names":[],"mappings":";AAAA;;;;;;;;;;;;;;;;;;;;KAOM;;;;;aAKE,mBAAI,MAAM;AAChB,OAAI,SAAS,SAAS,aAAT,CAAuB,QAAvB,CAAT,CADY;AAEhB,UAAO,IAAP,GAAc,IAAd,CAFgB;AAGhB,YAAS,IAAT,CAAc,WAAd,CAA0B,MAA1B,EAAkC,UAAlC,CAA6C,WAA7C,CAAyD,MAAzD,EAHgB;;;AALZ,aAiBE,2BAAQ,KAAK,cAAc;AACjC,OAAI,SAAS,SAAS,aAAT,CAAuB,QAAvB,CAAT,CAD6B;AAEjC,UAAO,GAAP,GAAa,GAAb,CAFiC;;AAIjC,OAAI,WAAW,SAAX,QAAW,GAAW;AACzB,WAAO,UAAP,CAAkB,WAAlB,CAA8B,MAA9B,EADyB;AAEzB,oBAAgB,cAAhB,CAFyB;IAAX,CAJkB;AAQjC,iBAAI,EAAJ,CAAO,MAAP,EAAe,MAAf,EAAuB,QAAvB,EARiC;AASjC,iBAAI,EAAJ,CAAO,MAAP,EAAe,OAAf,EAAwB,QAAxB,EATiC;AAUjC,YAAS,IAAT,CAAc,WAAd,CAA0B,MAA1B,EAViC;;;AAjB7B,aAoCE,+BAAU,QAAQ,cAAc;AACtC,OAAI,OAAO,IAAP,IAAe,OAAO,IAAP,KAAgB,iBAAhB,EAAmC;AACrD,oBAAgB,cAAhB,CADqD;AAErD,WAFqD;IAAtD;AAIA,OAAI,OAAO,UAAP,EAAmB;AACtB,WAAO,UAAP,CAAkB,WAAlB,CAA8B,MAA9B,EADsB;IAAvB;AAGA,OAAI,OAAO,GAAP,EAAY;AACf,eAAW,OAAX,CAAmB,OAAO,GAAP,EAAY,YAA/B,EADe;IAAhB,MAEO;AACN,eAAW,GAAX,CAAe,OAAO,IAAP,CAAf,CADM;AAEN,oBAAgB,cAAhB,CAFM;IAFP;;;AA5CI,aA0DE,mDAAoB,SAAS,cAAc;AACjD,OAAI,UAAU,QAAQ,gBAAR,CAAyB,QAAzB,CAAV,CAD6C;AAEjD,OAAI,QAAQ,MAAR,EAAgB;AACnB,eAAW,iBAAX,CAA6B,OAA7B,EAAsC,CAAtC,EAAyC,YAAzC,EADmB;IAApB,MAEO,IAAI,YAAJ,EAAkB;AACxB,mBADwB;IAAlB;;;AA9DH,aA0EE,+CAAkB,SAAS,OAAO,cAAc;AACtD,cAAW,SAAX,CAAqB,QAAQ,IAAR,CAAa,KAAb,CAArB,EAA0C,YAAW;AACpD,QAAI,QAAQ,QAAQ,MAAR,GAAiB,CAAjB,EAAoB;AAC/B,gBAAW,iBAAX,CAA6B,OAA7B,EAAsC,QAAQ,CAAR,EAAW,YAAjD,EAD+B;KAAhC,MAEO,IAAI,YAAJ,EAAkB;AACxB,oBADwB;KAAlB;IAHkC,CAA1C,CADsD;;;SA1ElD;;;mBAqFS","file":"node_modules/metal-dom/src/globalEval.js","sourcesContent":["'use strict';\n\nimport dom from './dom';\n\n/**\n * Utility functions for running javascript code in the global scope.\n */\nclass globalEval {\n\t/**\n\t * Evaluates the given string in the global scope.\n\t * @param {string} text\n\t */\n\tstatic run(text) {\n\t\tvar script = document.createElement('script');\n\t\tscript.text = text;\n\t\tdocument.head.appendChild(script).parentNode.removeChild(script);\n\t}\n\n\t/**\n\t * Evaluates the given javascript file in the global scope.\n\t * @param {string} src The file's path.\n\t * @param {function()=} opt_callback Optional function to be called\n\t *   when the script has been run.\n\t */\n\tstatic runFile(src, opt_callback) {\n\t\tvar script = document.createElement('script');\n\t\tscript.src = src;\n\n\t\tvar callback = function() {\n\t\t\tscript.parentNode.removeChild(script);\n\t\t\topt_callback && opt_callback();\n\t\t};\n\t\tdom.on(script, 'load', callback);\n\t\tdom.on(script, 'error', callback);\n\t\tdocument.head.appendChild(script);\n\t}\n\n\t/**\n\t * Evaluates the code referenced by the given script element.\n\t * @param {!Element} script\n\t * @param {function()=} opt_callback Optional function to be called\n\t *   when the script has been run.\n\t */\n\tstatic runScript(script, opt_callback) {\n\t\tif (script.type && script.type !== 'text/javascript') {\n\t\t\topt_callback && opt_callback();\n\t\t\treturn;\n\t\t}\n\t\tif (script.parentNode) {\n\t\t\tscript.parentNode.removeChild(script);\n\t\t}\n\t\tif (script.src) {\n\t\t\tglobalEval.runFile(script.src, opt_callback);\n\t\t} else {\n\t\t\tglobalEval.run(script.text);\n\t\t\topt_callback && opt_callback();\n\t\t}\n\t}\n\n\t/**\n\t * Evaluates any script tags present in the given element.\n\t * @params {!Element} element\n\t * @param {function()=} opt_callback Optional function to be called\n\t *   when the script has been run.\n\t */\n\tstatic runScriptsInElement(element, opt_callback) {\n\t\tvar scripts = element.querySelectorAll('script');\n\t\tif (scripts.length) {\n\t\t\tglobalEval.runScriptsInOrder(scripts, 0, opt_callback);\n\t\t} else if (opt_callback) {\n\t\t\topt_callback();\n\t\t}\n\t}\n\n\t/**\n\t * Runs the given scripts elements in the order that they appear.\n\t * @param {!NodeList} scripts\n\t * @param {number} index\n\t * @param {function()=} opt_callback Optional function to be called\n\t *   when the script has been run.\n\t */\n\tstatic runScriptsInOrder(scripts, index, opt_callback) {\n\t\tglobalEval.runScript(scripts.item(index), function() {\n\t\t\tif (index < scripts.length - 1) {\n\t\t\t\tglobalEval.runScriptsInOrder(scripts, index + 1, opt_callback);\n\t\t\t} else if (opt_callback) {\n\t\t\t\topt_callback();\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport default globalEval;\n"],"sourceRoot":"/source/"}