define(["exports","metal/src/metal","metal-component/src/all/component","html2incdom/src/withParser","metal-incremental-dom/src/IncrementalDomRenderer","./SoyAop","metal-soy-bundle/build/bundle","./requireWarning"],function(t,e,n,o,r,i){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0}),t.SoyAop=t.Soy=void 0;var s=a(e),d=a(o),f=a(r),p=a(i),m={},g=function(t){function e(){return l(this,e),c(this,t.apply(this,arguments))}return u(e,t),e.prototype.addMissingStateKeys_=function(t){if(!this.addedMissingStateKeys_){this.addedMissingStateKeys_=!0;for(var e=this.component_,n=0;n<t.length;n++)e.getStateKeyConfig(t[n])||e[t[n]]||e.addToState(t[n],{},e.getInitialConfig()[t[n]])}},e.prototype.buildTemplateData_=function(t){var n=this.component_,o={};n.getStateKeys().forEach(function(t){if("element"!==t){var r=n[t];n.getStateKeyConfig(t).isHtml&&(r=e.toIncDom(r)),o[t]=r}});for(var r=0;r<t.length;r++)!o[t[r]]&&s["default"].isFunction(n[t[r]])&&(o[t[r]]=n[t[r]].bind(n));return o},e.getTemplate=function(t,e){return function(n,o,r){if(!goog.loadedModules_[t])throw new Error('No template with namespace "'+t+'" has been loaded yet.');return goog.loadedModules_[t][e](n,o,r)}},e.handleInterceptedCall_=function(t,e){var n=t.componentCtor,o=e;IncrementalDOM.elementVoid("Component",null,[],"ctor",n,"data",o)},e.register=function(t,o){var r=arguments.length<=2||void 0===arguments[2]?"render":arguments[2];t.RENDERER=e,t.TEMPLATE=p["default"].getOriginalFn(o[r]),t.TEMPLATE.componentCtor=t,p["default"].registerForInterception(o,r),n.ComponentRegistry.register(t)},e.prototype.renderIncDom=function(){var n=this.component_.constructor.TEMPLATE;s["default"].isFunction(n)?(n=p["default"].getOriginalFn(n),this.addMissingStateKeys_(n.params),p["default"].startInterception(e.handleInterceptedCall_),n(this.buildTemplateData_(n.params),null,m),p["default"].stopInterception()):t.prototype.renderIncDom.call(this)},e.setInjectedData=function(t){m=t||{}},e.prototype.shouldUpdate=function(t){for(var e=this.component_.constructor.TEMPLATE,n=e?p["default"].getOriginalFn(e).params:[],o=0;o<n.length;o++)if(t[n[o]])return!0;return!1},e.toHtmlString=function(t){var e=document.createElement("div");return IncrementalDOM.patch(e,t),e.innerHTML},e.toIncDom=function(t){return s["default"].isObject(t)&&s["default"].isString(t.content)&&"HTML"===t.contentKind&&(t=t.content),s["default"].isString(t)&&(t=d["default"].buildFn(t)),t},e}(f["default"]);t["default"]=g,t.Soy=g,t.SoyAop=p["default"]});