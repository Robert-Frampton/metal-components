define(["exports","metal/src/metal","metal-state/src/all/state","metal-position/src/all/position"],function(t,e,o,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(t,"__esModule",{value:!0});var s=r(e),u=r(o),c=r(n),f=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),p=function h(t,e,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:h(r,e,o)}if("value"in n)return n.value;var i=n.get;if(void 0!==i)return i.call(o)},d=function(t){function e(t){i(this,e);var o=l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.scrollTimeout_=null,o}return a(e,t),f(e,[{key:"disposeInternal",value:function(){p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disposeInternal",this).call(this),this.stop()}},{key:"getRegionWithoutScroll_",value:function(t){if(s["default"].isDocument(t)){var e=window.innerHeight,o=window.innerWidth;return c["default"].makeRegion(e,e,0,o,0,o)}return c["default"].getRegion(t)}},{key:"scroll",value:function(t,e,o){this.stop(),this.scrollTimeout_=setTimeout(this.scrollInternal_.bind(this,t,e,o),this.delay)}},{key:"scrollElement_",value:function(t,e,o){s["default"].isDocument(t)?window.scrollBy(e,o):(t.scrollTop+=o,t.scrollLeft+=e)}},{key:"scrollInternal_",value:function(t,e,o){for(var n=0;n<t.length;n++){var r=this.getRegionWithoutScroll_(t[n]);if(c["default"].pointInsideRegion(e,o,r)){var i=0,l=0,a=c["default"].getScrollTop(t[n]),s=c["default"].getScrollLeft(t[n]);if(s>0&&Math.abs(e-r.left)<=this.maxDistance?i-=this.speed:Math.abs(e-r.right)<=this.maxDistance&&(i+=this.speed),a>0&&Math.abs(o-r.top)<=this.maxDistance?l-=this.speed:Math.abs(o-r.bottom)<=this.maxDistance&&(l+=this.speed),i||l){this.scrollElement_(t[n],i,l),this.scroll(t,e,o);break}}}}},{key:"stop",value:function(){clearTimeout(this.scrollTimeout_)}}]),e}(u["default"]);d.STATE={delay:{validator:s["default"].isNumber,value:50},maxDistance:{validator:s["default"].isNumber,value:20},speed:{validator:s["default"].isNumber,value:20}},t["default"]=d});