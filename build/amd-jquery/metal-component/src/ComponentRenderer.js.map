{"version":3,"sources":["ComponentRenderer.js"],"names":["ComponentRenderer","component","component_","componentRendererEvents_","add","once","render","bind","on","handleRendered_","handleDataManagerCreated_","disposeInternal","removeAllListeners","manager","getDataManager","constructor","SYNC_UPDATES_MERGED","handleManagerDataPropChanged_","handleManagerDataChanged_","changes","shouldRerender_","update","data","key","isRendered_","element","document","createElement","emit","skipUpdates_","startSkipUpdates","stopSkipUpdates"],"mappings":";AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KAQMA,iB;;;AACL;;;;;AAKA,6BAAYC,SAAZ,EAAuB;AAAA;;AAAA,gDACtB,wBADsB;;AAEtB,SAAKC,UAAL,GAAkBD,SAAlB;;AAEA,SAAKE,wBAAL,GAAgC,0BAAhC;AACA,SAAKA,wBAAL,CAA8BC,GAA9B,CACC,MAAKF,UAAL,CAAgBG,IAAhB,CAAqB,QAArB,EAA+B,MAAKC,MAAL,CAAYC,IAAZ,OAA/B,CADD;AAGA,SAAKC,EAAL,CAAQ,UAAR,EAAoB,MAAKC,eAAzB;AACAR,aAAUO,EAAV,CAAa,oBAAb,EAAmC,MAAKE,yBAAL,CAA+BH,IAA/B,OAAnC;AATsB;AAUtB;;AAED;;;;;8BAGAI,e,8BAAkB;AACjB,QAAKR,wBAAL,CAA8BS,kBAA9B;AACA,QAAKT,wBAAL,GAAgC,IAAhC;AACA,G;;8BAODO,yB,wCAA4B;AAC3B,OAAMG,UAAU,KAAKX,UAAL,CAAgBY,cAAhB,EAAhB;AACA,OAAI,KAAKZ,UAAL,CAAgBa,WAAhB,CAA4BC,mBAAhC,EAAqD;AACpD,SAAKb,wBAAL,CAA8BC,GAA9B,CACCS,QAAQL,EAAR,CACC,iBADD,EAEC,KAAKS,6BAAL,CAAmCV,IAAnC,CAAwC,IAAxC,CAFD,CADD;AAMA,IAPD,MAOO;AACN,SAAKJ,wBAAL,CAA8BC,GAA9B,CACCS,QAAQL,EAAR,CACC,aADD,EAEC,KAAKU,yBAAL,CAA+BX,IAA/B,CAAoC,IAApC,CAFD,CADD;AAMA;AACD,G;;8BAWDW,yB,sCAA0BC,O,EAAS;AAClC,OAAI,KAAKC,eAAL,EAAJ,EAA4B;AAC3B,SAAKC,MAAL,CAAYF,OAAZ;AACA;AACD,G;;8BASDF,6B,0CAA8BK,I,EAAM;AACnC,OAAI,KAAKF,eAAL,EAAJ,EAA4B;AAC3B,SAAKC,MAAL,CAAY;AACXF,kCACEG,KAAKC,GADP,EACaD,IADb;AADW,KAAZ;AAKA;AACD,G;;8BAMDb,e,8BAAkB;AACjB,QAAKe,WAAL,GAAmB,IAAnB;AACA,G;;8BAKDlB,M,qBAAS;AACR,OAAI,CAAC,KAAKJ,UAAL,CAAgBuB,OAArB,EAA8B;AAC7B,SAAKvB,UAAL,CAAgBuB,OAAhB,GAA0BC,SAASC,aAAT,CAAuB,KAAvB,CAA1B;AACA;AACD,QAAKC,IAAL,CAAU,UAAV,EAAsB,CAAC,KAAKJ,WAA5B;AACA,G;;8BAODJ,e,8BAAkB;AACjB,UAAO,KAAKI,WAAL,IAAoB,CAAC,KAAKK,YAAjC;AACA,G;;8BAKDC,gB,+BAAmB;AAClB,QAAKD,YAAL,GAAoB,IAApB;AACA,G;;8BAKDE,e,8BAAkB;AACjB,QAAKF,YAAL,GAAoB,KAApB;AACA,G;;8BASDR,M,qBAAS,CAAE,C;;;;;mBAGGrB,iB","file":"node_modules/metal-component/src/ComponentRenderer.js","sourcesContent":["'use strict';\n\nimport { EventEmitter, EventHandler } from 'metal-events';\n\n/**\n * Base class that component renderers should extend from. It defines the\n * required methods all renderers should have.\n */\nclass ComponentRenderer extends EventEmitter {\n\t/**\n\t * Constructor function for `ComponentRenderer`.\n\t * @param {!Component} component The component that this renderer is\n\t *     responsible for.\n\t */\n\tconstructor(component) {\n\t\tsuper();\n\t\tthis.component_ = component;\n\n\t\tthis.componentRendererEvents_ = new EventHandler();\n\t\tthis.componentRendererEvents_.add(\n\t\t\tthis.component_.once('render', this.render.bind(this))\n\t\t);\n\t\tthis.on('rendered', this.handleRendered_);\n\t\tcomponent.on('dataManagerCreated', this.handleDataManagerCreated_.bind(this));\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tdisposeInternal() {\n\t\tthis.componentRendererEvents_.removeAllListeners();\n\t\tthis.componentRendererEvents_ = null;\n\t}\n\n\t/**\n\t * Handles a `dataManagerCreated` event from the component. Listens to events\n\t * on the manager that has been created.\n\t * @protected\n\t */\n\thandleDataManagerCreated_() {\n\t\tconst manager = this.component_.getDataManager();\n\t\tif (this.component_.constructor.SYNC_UPDATES_MERGED) {\n\t\t\tthis.componentRendererEvents_.add(\n\t\t\t\tmanager.on(\n\t\t\t\t\t'dataPropChanged',\n\t\t\t\t\tthis.handleManagerDataPropChanged_.bind(this)\n\t\t\t\t)\n\t\t\t);\n\t\t} else {\n\t\t\tthis.componentRendererEvents_.add(\n\t\t\t\tmanager.on(\n\t\t\t\t\t'dataChanged',\n\t\t\t\t\tthis.handleManagerDataChanged_.bind(this)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Handles a `dataChanged` event from the component's data manager. Calls the\n\t * `update` function if the component has already been rendered for the first\n\t * time.\n\t * @param {!Object<string, Object>} changes Object containing the names\n\t *     of all changed state keys, each mapped to an object with its new\n\t *     (newVal) and previous (prevVal) values.\n\t * @protected\n\t */\n\thandleManagerDataChanged_(changes) {\n\t\tif (this.shouldRerender_()) {\n\t\t\tthis.update(changes);\n\t\t}\n\t}\n\n\t/**\n\t * Handles a `dataPropChanged` event from the component's data manager. This\n\t * is similar to `handleManagerDataChanged_`, but only called for\n\t * components that have requested updates to happen synchronously.\n\t * @param {!{key: string, newVal: *, prevVal: *}} data\n\t * @protected\n\t */\n\thandleManagerDataPropChanged_(data) {\n\t\tif (this.shouldRerender_()) {\n\t\t\tthis.update({\n\t\t\t\tchanges: {\n\t\t\t\t\t[data.key]: data\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Handles the \"rendered\" event.\n\t * @protected\n\t */\n\thandleRendered_() {\n\t\tthis.isRendered_ = true;\n\t}\n\n\t/**\n\t * Renders the component's whole content (including its main element).\n\t */\n\trender() {\n\t\tif (!this.component_.element) {\n\t\t\tthis.component_.element = document.createElement('div');\n\t\t}\n\t\tthis.emit('rendered', !this.isRendered_);\n\t}\n\n\t/**\n\t * Checks if changes should cause a rerender right now.\n\t * @return {boolean}\n\t * @protected\n\t */\n\tshouldRerender_() {\n\t\treturn this.isRendered_ && !this.skipUpdates_;\n\t}\n\n\t/**\n\t * Skips updates until `stopSkipUpdates` is called.\n\t */\n\tstartSkipUpdates() {\n\t\tthis.skipUpdates_ = true;\n\t}\n\n\t/**\n\t * Stops skipping updates.\n\t */\n\tstopSkipUpdates() {\n\t\tthis.skipUpdates_ = false;\n\t}\n\n\t/**\n\t * Updates the component's element html. This is automatically called when\n\t * the value of at least one of the component's state keys has changed.\n\t * @param {Object.<string, Object>} changes Object containing the names\n\t *     of all changed state keys, each mapped to an object with its new\n\t *     (newVal) and previous (prevVal) values.\n\t */\n\tupdate() {}\n}\n\nexport default ComponentRenderer;\n"],"sourceRoot":"/source/"}