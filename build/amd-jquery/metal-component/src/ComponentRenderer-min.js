define(["exports","metal-events/src/events"],function(e,n){"use strict";function t(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function r(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function s(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(e){function i(t){o(this,i);var s=r(this,e.call(this));return s.component_=t,s.componentRendererEvents_=new n.EventHandler,s.componentRendererEvents_.add(s.component_.once("render",s.render.bind(s))),s.on("rendered",s.handleRendered_),s.component_.constructor.SYNC_UPDATES_MERGED?s.componentRendererEvents_.add(s.component_.on("stateKeyChanged",s.handleComponentRendererStateKeyChanged_.bind(s))):s.componentRendererEvents_.add(s.component_.on("stateChanged",s.handleComponentRendererStateChanged_.bind(s))),s}return s(i,e),i.prototype.disposeInternal=function(){this.componentRendererEvents_.removeAllListeners(),this.componentRendererEvents_=null},i.prototype.handleComponentRendererStateChanged_=function(e){this.shouldRerender_(e)&&this.update(e)},i.prototype.handleComponentRendererStateKeyChanged_=function(e){var n={changes:t({},e.key,e)};this.shouldRerender_(n)&&this.update(n)},i.prototype.handleRendered_=function(){this.isRendered_=!0},i.prototype.hasChangedBesidesElement_=function(e){var n=Object.keys(e).length;return e.hasOwnProperty("element")&&n--,n>0},i.prototype.render=function(){this.component_.element||(this.component_.element=document.createElement("div")),this.emit("rendered",!this.isRendered_)},i.prototype.shouldRerender_=function(e){return this.isRendered_&&!this.skipUpdates_&&this.hasChangedBesidesElement_(e.changes)},i.prototype.startSkipUpdates=function(){this.skipUpdates_=!0},i.prototype.stopSkipUpdates=function(){this.skipUpdates_=!1},i.prototype.update=function(){},i}(n.EventEmitter);e["default"]=i});